<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AJAX Weather Dashboard</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; padding: 50px; background: #e0eafc; }
        .card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 350px; text-align: center; }
        input { width: 80%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-bottom: 10px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        
        #loader { display: none; margin: 20px auto; border: 4px solid #f3f3f3; border-top: 4px solid #3498db; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        .weather-info { margin-top: 20px; display: none; }
        .error { color: #d9534f; margin-top: 15px; font-weight: bold; }
        .cache-note { font-size: 0.8rem; color: #888; margin-top: 15px; }
    </style>
</head>
<body>

<div class="card">
    <h2>Weather Dashboard</h2>
    <input type="text" id="cityInput" placeholder="Enter city name...">
    <button onclick="getWeather()">Search</button>

    <div id="loader"></div>
    <div id="errorMsg" class="error"></div>

    <div id="weatherDisplay" class="weather-info">
        <h3 id="cityName"></h3>
        <p><strong>Condition:</strong> <span id="condition"></span></p>
        <p><strong>Temperature:</strong> <span id="temp"></span>Â°C</p>
        <p><strong>Humidity:</strong> <span id="humidity"></span>%</p>
    </div>
    
    <div id="cacheInfo" class="cache-note"></div>
</div>

<script>
    const API_KEY = 'YOUR_OPENWEATHER_API_KEY'; // Replace with your actual key
    let lastResult = null; // Cache variable

    async function getWeather() {
        const city = document.getElementById('cityInput').value.trim();
        const display = document.getElementById('weatherDisplay');
        const loader = document.getElementById('loader');
        const errorMsg = document.getElementById('errorMsg');
        const cacheInfo = document.getElementById('cacheInfo');

        if (!city) return;

        // Reset UI
        display.style.display = 'none';
        errorMsg.textContent = '';
        loader.style.display = 'block';

        try {
            // GET request with query parameters
            const url = `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${API_KEY}&units=metric`;
            const response = await fetch(url);

            if (!response.ok) {
                if (response.status === 404) throw new Error("City not found.");
                throw new Error("Network error occurred.");
            }

            const data = await response.json();
            
            // Cache the result in a JS variable
            lastResult = data;

            // Update UI dynamically
            document.getElementById('cityName').textContent = data.name;
            document.getElementById('condition').textContent = data.weather[0].main;
            document.getElementById('temp').textContent = data.main.temp;
            document.getElementById('humidity').textContent = data.main.humidity;

            display.style.display = 'block';
            cacheInfo.textContent = `Last searched: ${lastResult.name}`;

        } catch (err) {
            errorMsg.textContent = err.message;
        } finally {
            loader.style.display = 'none';
        }
    }
</script>

</body>
</html>